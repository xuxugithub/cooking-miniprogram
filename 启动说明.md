# 小程序启动说明

## 🚀 快速启动

### 前置要求
- **Java 8+**：确保系统安装了Java 8或更高版本
- **Maven 3.6+**：用于构建项目
- **MySQL 5.7+**：数据库服务
- **微信开发者工具**：用于运行小程序

### ⚠️ 重要说明
**小程序接口已配置为公开访问，无需登录即可使用。这样设计是为了方便测试和演示。**

### 1. 后端服务启动  

1. **配置数据库**
   
   在 `src/main/resources/application.yml` 中配置数据库连接：
   ```yaml
   spring:
     datasource:
       url: jdbc:mysql://localhost:3306/cooking_db?useUnicode=true&characterEncoding=utf8&serverTimezone=GMT%2B8
       username: root
       password: your_password
   ```

2. **启动后端服务**
   ```bash
   # 在项目根目录执行
   mvn spring-boot:run
   ```
   或者在IDE中直接运行 `CookingApplication.java`

3. **验证服务启动**
   
   服务启动成功后，访问：http://localhost:8080
   
   如果看到欢迎页面，说明服务启动成功。

4. **初始化数据**
   
   后端启动成功后，访问以下接口初始化Mock数据：
   
   ```bash
   # 初始化所有数据（推荐）
   POST http://localhost:8080/admin/data-init/all
   
   # 或者分别初始化
   POST http://localhost:8080/admin/data-init/banner        # Banner数据
   POST http://localhost:8080/admin/data-init/category      # 分类数据
   POST http://localhost:8080/admin/data-init/dish          # 菜品数据
   POST http://localhost:8080/admin/data-init/dish-ingredients  # 食材数据
   POST http://localhost:8080/admin/data-init/dish-steps    # 制作步骤数据
   ```

   **使用Postman、curl或其他工具发送POST请求到上述地址即可**
   
   示例curl命令：
   ```bash
   curl -X POST http://localhost:8080/admin/data-init/all
   ```

### 2. 小程序启动

1. **打开微信开发者工具**

2. **导入项目**
   - 选择 `cooking-miniprogram` 文件夹
   - AppID可以使用测试号或者选择"不使用云服务"

3. **检查配置**
   - 确保 `app.js` 中的 `baseUrl` 指向正确的后端地址：
     ```javascript
     globalData: {
       baseUrl: 'http://localhost:8080'  // 后端服务地址
     }
     ```

4. **编译运行**
   - 点击"编译"按钮
   - 小程序应该能正常显示首页内容

## 📊 Mock数据说明

### Banner数据
- 4个轮播Banner
- 包含标题和图片
- 支持点击跳转到菜品详情

### 分类数据
- 8个菜品分类：家常菜、川菜、粤菜、湘菜、素食、汤品、甜品、小食
- 每个分类都有对应的图标

### 菜品数据
- 20个精选菜品
- 涵盖所有分类
- 包含完整的菜品信息：名称、图片、描述、难度、时间、热量等
- 模拟真实的浏览量、收藏量、分享量数据

### 食材数据
- 为前5个菜品添加了详细的食材清单
- 包含食材名称、用量、单位

### 制作步骤数据
- 为前5个菜品添加了详细的制作步骤
- 每个步骤包含描述和配图

## 🎯 功能验证

初始化数据后，可以验证以下功能：

### 首页功能
- ✅ Banner轮播展示
- ✅ 分类导航（显示8个分类）
- ✅ 热门推荐（按浏览量排序）
- ✅ 为你推荐（按创建时间排序）

### 分类页面
- ✅ 分类列表展示
- ✅ 点击分类查看对应菜品
- ✅ 热门菜品专区

### 搜索功能
- ✅ 搜索菜品名称
- ✅ 搜索历史记录
- ✅ 热门搜索关键词

### 菜品详情
- ✅ 菜品基本信息
- ✅ 食材清单（前5个菜品有数据）
- ✅ 制作步骤（前5个菜品有数据）
- ✅ 收藏功能（本地存储）

### 收藏功能
- ✅ 添加/取消收藏
- ✅ 收藏列表管理
- ✅ 本地数据持久化

### 个人中心
- ✅ 用户信息展示
- ✅ 统计数据
- ✅ 功能菜单

## 🔧 常见问题解决

### 问题1：接口返回401错误
**原因**：接口被权限拦截器拦截
**解决方案**：
1. 确保使用最新的后端代码（已修复权限配置）
2. 重新启动后端服务
3. 小程序的核心浏览功能已配置为公开访问，无需登录

### 问题2：数据初始化失败
**原因**：数据初始化接口被拦截
**解决方案**：
1. 数据初始化接口已配置为公开访问
2. 直接发送POST请求到`/admin/data-init/all`即可

### 问题3：图片无法显示
**原因**：图片路径配置问题或图片文件不存在
**解决方案**：
1. 已更新Mock数据使用在线图片（Unsplash）
2. 已修复小程序中的图片URL处理函数
3. 重新初始化数据后图片应该正常显示

### 问题4：小程序网络请求失败
**原因**：微信小程序的网络安全限制
**解决方案**：
1. 在微信开发者工具中开启"不校验合法域名"
2. 或在小程序后台配置服务器域名白名单

## 🔧 接口地址

所有小程序接口都以 `/app` 开头：

- `GET /app/banner/list` - 获取Banner列表
- `GET /app/category/list` - 获取分类列表
- `GET /app/dish/page` - 获取菜品列表
- `GET /app/dish/hot` - 获取热门菜品
- `GET /app/dish/recommend` - 获取推荐菜品
- `GET /app/dish/{id}` - 获取菜品详情
- `GET /app/dish/search` - 搜索菜品
- `GET /app/dish-ingredient/list/{dishId}` - 获取菜品食材
- `GET /app/dish-step/list/{dishId}` - 获取制作步骤

## 🎨 界面特色

- **现代化设计**：采用橙色主题，圆角卡片设计
- **沉浸式首页**：全屏Banner + 浮动搜索栏
- **统一导航**：所有页面都有底部导航栏
- **流畅交互**：点击动画、加载状态、错误处理

## 📱 测试建议

1. **首页测试**：验证Banner轮播、分类导航、推荐内容
2. **搜索测试**：搜索"红烧肉"、"鸡丁"等关键词
3. **详情测试**：查看前5个菜品的完整信息
4. **收藏测试**：添加收藏并在收藏页面查看
5. **导航测试**：测试各页面间的跳转功能

现在小程序已经具备完整的功能和真实的数据展示！🎉