<!--pages/index/index.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨æœç´¢æ  -->
  <view class="top-search-bar">
    <view class="search-input-container">
      <text class="search-icon">ğŸ”</text>
      <input class="search-input-field" 
             placeholder="æœç´¢èœå“ã€é£Ÿæ..." 
             value="{{searchValue}}"
             bindinput="onSearchInput"
             bindconfirm="onSearchConfirm"
             confirm-type="search" />
      <text class="search-btn" bindtap="onSearchConfirm" wx:if="{{searchValue}}">æœç´¢</text>
    </view>
  </view>

  <!-- Bannerè½®æ’­ -->
  <view class="banner-section" wx:if="{{banners.length > 0}}">
    <swiper class="banner-swiper" indicator-dots="{{true}}" autoplay="{{true}}" interval="{{3000}}" duration="{{500}}">
      <swiper-item wx:for="{{banners}}" wx:key="id" bindtap="onBannerTap" data-item="{{item}}">
        <image class="banner-image" src="{{getImageUrl(item.image)}}" mode="aspectFill"></image>
        <view class="banner-overlay">
          <view class="banner-title" wx:if="{{item.title}}">{{item.title}}</view>
          <view class="banner-subtitle">å¨å°æ•™ï¼Œé›¶åŸºç¡€å­¦åšèœè¶…ç®€å•</view>
        </view>
      </swiper-item>
    </swiper>
  </view>

  <!-- åˆ†ç±»å¯¼èˆª -->
  <view class="category-section" wx:if="{{categories.length > 0}}">
    <view class="category-grid">
      <view class="category-item" wx:for="{{categories}}" wx:key="id" bindtap="onCategoryTap" data-category="{{item}}" wx:if="{{index < 6}}">
        <view class="category-icon-wrapper">
          <image class="category-icon" src="{{getImageUrl(item.image)}}" mode="aspectFill"></image>
        </view>
        <text class="category-name">{{item.name}}</text>
      </view>
      <view class="category-item" bindtap="goToCategory">
        <view class="category-icon-wrapper more-icon">
          <text class="more-text">æ›´å¤š</text>
        </view>
        <text class="category-name">æ›´å¤š</text>
      </view>
    </view>
  </view>

  <!-- ä¸ªäººæ¨èèœå“ -->
  <view class="recommend-section" wx:if="{{allDishes.length > 0}}">
    <view class="section-header">
      <text class="section-title">å…¨éƒ¨èœå“</text>
      <!-- æ’åºé€‰é¡¹ -->
      <view class="sort-options">
        <view class="sort-item {{currentSortType === item.key ? 'active' : ''}}" 
              wx:for="{{sortOptions}}" 
              wx:key="key" 
              bindtap="onSortChange" 
              data-sort="{{item.key}}">
          {{item.name}}
        </view>
      </view>
    </view>
    <view class="recommend-grid">
      <view class="recommend-item" wx:for="{{allDishes}}" wx:key="id" bindtap="onDishTap" data-dish="{{item}}">
        <image class="recommend-image" src="{{getImageUrl(item.image)}}" mode="aspectFill"></image>
        <view class="recommend-info">
          <text class="recommend-name">{{item.name}}</text>
          <view class="recommend-meta">
            <text class="recommend-category">{{item.categoryName}}</text>
            <text class="recommend-time">{{item.cookingTime}}åˆ†é’Ÿ</text>
          </view>
          <view class="recommend-stats">
            <text class="stat-item">ğŸ‘ï¸ {{item.viewCount || 0}}</text>
            <text class="stat-item">â¤ï¸ {{item.collectCount || 0}}</text>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åŠ è½½æ›´å¤š -->
    <view class="load-more" wx:if="{{loadingMore}}">
      <text>åŠ è½½ä¸­...</text>
    </view>
    
    <!-- æ²¡æœ‰æ›´å¤šæ•°æ® -->
    <view class="no-more" wx:if="{{!hasMore && allDishes.length > 0}}">
      <text>æ²¡æœ‰æ›´å¤šæ•°æ®äº†</text>
    </view>
  </view>

  <!-- åŠ è½½çŠ¶æ€ -->
  <view class="loading" wx:if="{{loading}}">
    <text>åŠ è½½ä¸­...</text>
  </view>

  <!-- ç©ºçŠ¶æ€ -->
  <view class="empty" wx:if="{{!loading && banners.length === 0 && categories.length === 0 && allDishes.length === 0}}">
    <text class="empty-icon">ğŸ½ï¸</text>
    <text class="empty-text">æš‚æ— æ•°æ®</text>
  </view>

  <!-- åº•éƒ¨å¯¼èˆªæ  -->
  <view class="bottom-nav">
    <view class="nav-item active">
      <view class="nav-icon">ğŸ </view>
      <text class="nav-text">ä¸‹å¨æˆ¿</text>
    </view>
    <view class="nav-item" bindtap="goToCategory">
      <view class="nav-icon">ğŸ“‚</view>
      <text class="nav-text">åˆ†ç±»</text>
    </view>
    <view class="nav-item" bindtap="goToFavorites">
      <view class="nav-icon">â­</view>
      <text class="nav-text">æ”¶è—</text>
    </view>
    <view class="nav-item" bindtap="goToProfile">
      <view class="nav-icon">ğŸ‘¤</view>
      <text class="nav-text">æˆ‘çš„</text>
    </view>
  </view>
</view>